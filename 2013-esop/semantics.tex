%!TEX root = ./recycling.tex
 
\subsection{Soundness\label{sec:semantics}}
Let us denote by $\Prog$ the set of programs $\cp$ with an additional command
$\done$, describing a completed computation. The language of
\S\ref{sec:setting} has a standard small-step operational semantics, defined by
a relation $\longrightarrow : \Config \times \Config$, which transforms
configurations from the set $\Config = (\Prog \times \State)\cup {\{\top\}}$. 
(Note that this semantics ignores the effects of weak memory consistency models,
which are left for future work.)
%A configuration $(\cp, \theta)$ describes a program $\cp$ with the memory in a
%state $\theta$, and $\top$ represents an error state.
We defer the definition of $\longrightarrow$ to
\tr{\ref{app:formal}}{\nformal}. The following theorem is proved in
\tr{\ref{app:soundness}}{\nsoundness}.
%The definition extends the
%set of commands with $\done$, which describes a completed computation.
\begin{theorem}[Soundness]\label{real:soundness}
  Assume $\vdash \{P\}\,\cp\,\{Q\}$ and take $\theta_l$, $\theta_s$ and $\intp$
  such that $\theta_l, \theta_s,\intp \models P$. Then $(\cp,\theta_l *
  \theta_s) \nmyarrow^* \top$ and, whenever $(\cp, \theta_l * \theta_s)
  \longrightarrow^* (\done \parallel \ldots \parallel \done, \theta')$, for some
  $\theta'_l$, $\theta'_s$ and $\xi$ we have $\theta' = \theta'_l * \theta'_s$ and
  $\theta'_l,\xi\theta'_s,\intp \models Q$.
\end{theorem}
% The proof %is given in   
% \tr{\ref{app:soundness}}{\nsoundness} %. It
% relies on the
% notion of validity of judgements that takes into account the history of the
% shared state given by assertions and the temporal invariant.

%%% Local Variables:
%%% TeX-master: "recycling"
%%% End:  
